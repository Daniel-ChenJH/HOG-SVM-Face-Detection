# 使用HoG+SVM进行人脸检测

本课题针对RAF-DB人脸数据集的部分子集，在生成负例后提取HOG特征，并利用SVM检测人脸存在性。接着对于存在人脸的候选框进行候选框筛选，即采用NMS、soft-NMS、WBF等算法输出对于人脸的最终检测结果。

## 数据集构建

本次实验使用的数据集是RAF-DB的子集，共3954张图片。RAF-DB提供了原图、人脸裁剪图、检测边界框，但无负例图片，因此需要我们根据原图和边界框构建非人脸图片。

我们采用的构建策略是：在原图的人脸框左侧/上侧框选与人脸框相同大小的框作为负例图片并保存。如果图像尺寸受限，则在整个图像的左上角框选与人脸框相同大小的框作为负例图片并保存。

## 效果

在几种候选框筛选算法效果的对比方面:

- MSC算法
  - 简单高效，对于单个人脸的识别效果较好
  - 无法处理一张图片中存在多个人脸的情况
  - 预测框与真值框的IOU为0.612
- NMS算法
  - 可以同时完成多个人的识别
  - 虚警率较高
  - 无法通过筛选排除掉得分较低的人体手臂
  - 无法很好地处理多个目标时存在的遮挡问题
  - 预测框与真值框的IOU为0.652
- soft-NMS算法
  - 对NMS算法进行了优化，主要体现在对多目标遮挡识别的性能提升
  - 无法改善NMS算法存在的虚警率高的问题
  - 预测框与真值框的IOU为0.683
- WBF算法
  - 依据候选框得分对最终输出框的位置进行加权调整，能较好地完成多个人脸的有遮挡/侧脸识别
  - 虚警率较低
  - 存在一定的输出框偏离问题
  - 预测框与真值框的IOU为0.704

受限于数据集大小以及负例数据集的情况，我们认为soft-NMS算法以及WBF算法都对候选框筛选工作做出了值得肯定的提升。

# 说明
本项目是Daniel-ChenJH在2022年上海交通大学《图像处理与内容分析》课程中的大作业。

有关对本项目更详细的说明，可参阅报告report.docx。